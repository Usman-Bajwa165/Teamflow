{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Window/Desktop/Teamflow/frontend/src/components/dnd/SortableItem.tsx"],"sourcesContent":["// frontend/src/components/dnd/SortableItem.tsx\r\n'use client';\r\nimport React from 'react';\r\nimport { useSortable } from '@dnd-kit/sortable';\r\nimport { CSS } from '@dnd-kit/utilities';\r\n\r\nexport function SortableItem({ id, title, onOpen }: { id: string; title: string; onOpen?: () => void }) {\r\n  const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({ id });\r\n  const style: React.CSSProperties = {\r\n    transform: CSS.Transform.toString(transform),\r\n    transition,\r\n    cursor: isDragging ? 'grabbing' : 'grab',\r\n    zIndex: isDragging ? 50 : 'auto',\r\n  };\r\n\r\n  return (\r\n    <div ref={setNodeRef} style={style} {...attributes} {...listeners} className=\"p-2 bg-white rounded border flex items-center justify-between\">\r\n      <div className=\"text-sm truncate\">{title}</div>\r\n      <button onClick={onOpen} className=\"text-xs text-slate-500 ml-2\">⋯</button>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,+CAA+C;;;;;;AAG/C;AACA;AAHA;;;;AAKO,SAAS,aAAa,EAAE,EAAE,EAAE,KAAK,EAAE,MAAM,EAAsD;IACpG,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,UAAU,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU,EAAE,GAAG,IAAA,8LAAW,EAAC;QAAE;IAAG;IAClG,MAAM,QAA6B;QACjC,WAAW,wLAAG,CAAC,SAAS,CAAC,QAAQ,CAAC;QAClC;QACA,QAAQ,aAAa,aAAa;QAClC,QAAQ,aAAa,KAAK;IAC5B;IAEA,qBACE,0PAAC;QAAI,KAAK;QAAY,OAAO;QAAQ,GAAG,UAAU;QAAG,GAAG,SAAS;QAAE,WAAU;;0BAC3E,0PAAC;gBAAI,WAAU;0BAAoB;;;;;;0BACnC,0PAAC;gBAAO,SAAS;gBAAQ,WAAU;0BAA8B;;;;;;;;;;;;AAGvE","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Window/Desktop/Teamflow/frontend/src/components/TaskBoard.tsx"],"sourcesContent":["// frontend/src/components/TaskBoard.tsx\r\n'use client';\r\nimport React, { useState } from 'react';\r\nimport {\r\n  DndContext,\r\n  DragEndEvent,\r\n  PointerSensor,\r\n  useSensor,\r\n  useSensors,\r\n  closestCenter,\r\n  DragStartEvent,\r\n  useDroppable,\r\n} from '@dnd-kit/core';\r\nimport {\r\n  arrayMove,\r\n  SortableContext,\r\n  verticalListSortingStrategy,\r\n} from '@dnd-kit/sortable';\r\nimport { SortableItem } from './dnd/SortableItem';\r\n\r\nexport type Task = { id: string; title: string; position?: number; description?: string };\r\nexport type Column = { id: string; title: string; position?: number; tasks: Task[] };\r\n\r\ntype Props = {\r\n  columns: Column[]; // controlled source of truth\r\n  onMove: (taskId: string, targetColumnId: string, targetPosition: number) => Promise<void>;\r\n  onColumnsChange?: (cols: Column[]) => void; // called for optimistic updates & rollbacks\r\n  onAddTask?: (columnId: string, title: string) => Promise<void>;\r\n  onOpenTask?: (taskId: string) => void;\r\n};\r\n\r\nfunction EmptyDropPad({ colId }: { colId: string }) {\r\n  // give empty pad a distinct id so we can detect \"over empty column\" reliably\r\n  const dropId = `empty-${colId}`;\r\n  const { setNodeRef, isOver } = useDroppable({ id: dropId });\r\n  return (\r\n    <div\r\n      ref={setNodeRef}\r\n      data-empty-pad\r\n      style={{\r\n        minHeight: 48,\r\n        borderRadius: 6,\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        opacity: isOver ? 0.7 : 0.08,\r\n      }}\r\n      className=\"bg-white/10\"\r\n    >\r\n      {isOver ? 'Release to drop' : ''}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function TaskBoard({\r\n  columns = [],\r\n  onMove,\r\n  onColumnsChange,\r\n  onAddTask,\r\n  onOpenTask,\r\n}: Props) {\r\n  const sensors = useSensors(useSensor(PointerSensor, { activationConstraint: { distance: 5 } }));\r\n  const [newTaskTitles, setNewTaskTitles] = useState<Record<string, string>>({});\r\n\r\n  // helper to find column by either a task id or column id or empty-pad id\r\n  function findColumnByContainedId(id: string) {\r\n    // if id looks like 'empty-<colId>' treat as column id\r\n    if (id.startsWith('empty-')) {\r\n      const cid = id.slice('empty-'.length);\r\n      const byCol = columns.find((c) => c.id === cid);\r\n      if (byCol) return { column: byCol, matchedBy: 'empty-pad' as const, rawId: id };\r\n    }\r\n\r\n    // try task id\r\n    const byTask = columns.find((c) => (c.tasks || []).some((t) => t.id === id));\r\n    if (byTask) return { column: byTask, matchedBy: 'task' as const, rawId: id };\r\n\r\n    // try column id\r\n    const byCol = columns.find((c) => c.id === id);\r\n    if (byCol) return { column: byCol, matchedBy: 'column' as const, rawId: id };\r\n\r\n    return null;\r\n  }\r\n\r\n  async function handleDragEnd(event: DragEndEvent) {\r\n    const { active, over } = event;\r\n    if (!over) return;\r\n\r\n    const activeId = String(active.id);\r\n    const overId = String(over.id);\r\n    if (activeId === overId) return;\r\n\r\n    const sourceInfo = findColumnByContainedId(activeId);\r\n    const destInfo = findColumnByContainedId(overId);\r\n    if (!sourceInfo || !destInfo) return;\r\n\r\n    const sourceCol = sourceInfo.column;\r\n    const destCol = destInfo.column;\r\n\r\n    const prevCols = columns.map((c) => ({ ...c, tasks: [...(c.tasks || [])] }));\r\n\r\n    // same-column reorder (matched by task)\r\n    if (sourceCol.id === destCol.id && sourceInfo.matchedBy === 'task' && destInfo.matchedBy === 'task') {\r\n      const sourceIndex = sourceCol.tasks.findIndex((t) => t.id === activeId);\r\n      const destIndex = destCol.tasks.findIndex((t) => t.id === overId);\r\n      if (sourceIndex === -1 || destIndex === -1) return;\r\n\r\n      const newTasks = arrayMove([...sourceCol.tasks], sourceIndex, destIndex);\r\n      const newCols = columns.map((c) => (c.id === sourceCol.id ? { ...c, tasks: newTasks } : c));\r\n      onColumnsChange?.(newCols);\r\n      try {\r\n        await onMove(activeId, destCol.id, destIndex);\r\n      } catch {\r\n        onColumnsChange?.(prevCols);\r\n      }\r\n      return;\r\n    }\r\n\r\n    // cross-column move\r\n    const srcTasks = [...(sourceCol.tasks || [])];\r\n    const dstTasks = [...(destCol.tasks || [])];\r\n\r\n    const sourceIndex = srcTasks.findIndex((t) => t.id === activeId);\r\n    if (sourceIndex === -1) return;\r\n\r\n    // destIndex: if over matched as task -> index of that task; if matched as empty-pad or column, drop at end\r\n    let destIndex = dstTasks.findIndex((t) => t.id === overId);\r\n    if (destIndex === -1) {\r\n      // overId may be 'empty-<colId>' or the column id itself -> drop to end\r\n      destIndex = dstTasks.length;\r\n    }\r\n\r\n    const [moved] = srcTasks.splice(sourceIndex, 1);\r\n    dstTasks.splice(destIndex, 0, moved);\r\n\r\n    const newCols = columns.map((c) => {\r\n      if (c.id === sourceCol.id) return { ...c, tasks: srcTasks };\r\n      if (c.id === destCol.id) return { ...c, tasks: dstTasks };\r\n      return c;\r\n    });\r\n\r\n    onColumnsChange?.(newCols);\r\n\r\n    try {\r\n      await onMove(activeId, destCol.id, destIndex);\r\n    } catch {\r\n      onColumnsChange?.(prevCols);\r\n    }\r\n  }\r\n\r\n  function handleDragStart(_e: DragStartEvent) {\r\n    // reserved for future\r\n  }\r\n\r\n  async function handleAddTask(columnId: string) {\r\n    const title = (newTaskTitles[columnId] || '').trim();\r\n    if (!title) return;\r\n    // clear input immediately for snappy UX\r\n    setNewTaskTitles((s) => ({ ...s, [columnId]: '' }));\r\n    if (onAddTask) {\r\n      try {\r\n        await onAddTask(columnId, title);\r\n      } catch (err) {\r\n        // if adding failed, surface nothing here — parent will show message\r\n        // optionally restore title on failure\r\n        setNewTaskTitles((s) => ({ ...s, [columnId]: title }));\r\n      }\r\n    }\r\n  }\r\n\r\n  return (\r\n    <DndContext sensors={sensors} collisionDetection={closestCenter} onDragEnd={handleDragEnd} onDragStart={handleDragStart}>\r\n      <div className=\"w-full overflow-x-auto\">\r\n        <div className=\"flex gap-4 px-2\" style={{ minHeight: '60vh' }}>\r\n          {columns.map((col) => (\r\n            <div\r\n              key={col.id}\r\n              className=\"flex-shrink-0 bg-gray-100 rounded overflow-hidden\"\r\n              style={{\r\n                width: 320,\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                height: '70vh', // fixed column height\r\n              }}\r\n            >\r\n              {/* header (fixed) */}\r\n              <div className=\"px-3 py-2 border-b bg-white\" style={{ flexShrink: 0 }}>\r\n                <div className=\"font-semibold text-sm truncate\">{col.title}</div>\r\n              </div>\r\n\r\n              {/* body (scrolls) */}\r\n              <div className=\"p-3 overflow-y-auto\" style={{ flex: 1 }}>\r\n                <SortableContext items={(col.tasks || []).map((t) => t.id)} strategy={verticalListSortingStrategy}>\r\n                  <div className=\"space-y-2\">\r\n                    {(col.tasks || []).length > 0 ? (\r\n                      (col.tasks || []).map((t) => <SortableItem key={t.id} id={t.id} title={t.title} onOpen={() => onOpenTask?.(t.id)} />)\r\n                    ) : (\r\n                      // droppable pad for empty column (accept drops)\r\n                      <EmptyDropPad colId={col.id} />\r\n                    )}\r\n                  </div>\r\n                </SortableContext>\r\n              </div>\r\n\r\n              {/* footer - add task (fixed at bottom) */}\r\n              <div className=\"p-3 border-t bg-white\" style={{ flexShrink: 0 }}>\r\n                <div className=\"flex gap-2\">\r\n                  <input\r\n                    value={newTaskTitles[col.id] || ''}\r\n                    onChange={(e) => setNewTaskTitles((prev) => ({ ...prev, [col.id]: e.target.value }))}\r\n                    placeholder={`New task in ${col.title}`}\r\n                    className=\"flex-1 px-2 py-1 border rounded\"\r\n                  />\r\n                  <button\r\n                    onClick={() => handleAddTask(col.id)}\r\n                    className=\"px-3 py-1 bg-green-600 text-white rounded\"\r\n                  >\r\n                    Add\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </DndContext>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 380, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Window/Desktop/Teamflow/frontend/src/app/projects/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n// frontend/src/app/projects/[id]/page.tsx\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useParams } from \"next/navigation\";\r\nimport {\r\n  getProject,\r\n  createColumn,\r\n  createTask,\r\n  moveTask,\r\n} from \"../../../lib/api\";\r\nimport TaskBoard, { Column } from \"../../../components/TaskBoard\";\r\n\r\nexport default function ProjectBoard() {\r\n  const params = useParams();\r\n  const projectId = params.id;\r\n  const [project, setProject] = useState<any>(null);\r\n  const [newColTitle, setNewColTitle] = useState(\"\");\r\n  const [msg, setMsg] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      if (!projectId) return;\r\n      try {\r\n        const p = await getProject(projectId);\r\n        const normalized = {\r\n          ...p,\r\n          columns: (p?.columns || []).map((c: any) => ({\r\n            ...c,\r\n            tasks: c?.tasks || [],\r\n          })),\r\n        };\r\n        setProject(normalized);\r\n      } catch (err) {\r\n        setMsg(\"Failed to load project\");\r\n      }\r\n    })();\r\n  }, [projectId]);\r\n\r\n  async function addColumn(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    setMsg(null);\r\n    const title = (newColTitle || \"\").trim();\r\n    if (!title) {\r\n      setMsg(\"Column title required\");\r\n      return;\r\n    }\r\n    try {\r\n      const col = await createColumn(project.id, title);\r\n      const newCol = { ...col, tasks: col?.tasks || [] };\r\n      setProject((prev) => ({\r\n        ...(prev || {}),\r\n        columns: (prev?.columns || []).concat(newCol),\r\n      }));\r\n      setNewColTitle(\"\");\r\n    } catch (err: any) {\r\n      setMsg(err?.body?.message || \"Failed to create column\");\r\n    }\r\n  }\r\n\r\n  // called by TaskBoard for optimistic updates & rollbacks\r\n  function handleColumnsChange(cols: Column[]) {\r\n    setProject((prev) => ({ ...(prev || {}), columns: cols }));\r\n  }\r\n\r\n  // forward to API\r\n  async function handleMove(\r\n    taskId: string,\r\n    targetColumnId: string,\r\n    targetPosition: number\r\n  ) {\r\n    await moveTask(taskId, targetColumnId, targetPosition);\r\n  }\r\n\r\n  // called by TaskBoard footer add-button\r\n  async function handleAddTask(columnId: string, title: string) {\r\n    setMsg(null);\r\n    try {\r\n      const t = await createTask(columnId, title);\r\n      setProject((prev) => ({\r\n        ...(prev || {}),\r\n        columns: (prev?.columns || []).map((c: any) =>\r\n          c.id === columnId ? { ...c, tasks: [...(c.tasks || []), t] } : c\r\n        ),\r\n      }));\r\n    } catch (err: any) {\r\n      setMsg(err?.body?.message || \"Failed to create task\");\r\n      throw err; // rethrow so TaskBoard can optionally react (we already cleared input)\r\n    }\r\n  }\r\n\r\n  if (!project) return <div>Loading project...</div>;\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"text-2xl font-bold mb-4\">{project.name}</h2>\r\n      {msg && <div className=\"mb-3 text-red-600\">{msg}</div>}\r\n\r\n      <div className=\"mb-4\">\r\n        <form onSubmit={addColumn} className=\"flex gap-2\">\r\n          <input\r\n            value={newColTitle}\r\n            onChange={(e) => setNewColTitle(e.target.value)}\r\n            placeholder=\"New column title\"\r\n            className=\"px-3 py-2 border rounded flex-1\"\r\n          />\r\n          <button className=\"bg-slate-600 text-white px-3 py-2 rounded\">\r\n            Add column\r\n          </button>\r\n        </form>\r\n      </div>\r\n\r\n      <TaskBoard\r\n        columns={project.columns as Column[]}\r\n        onMove={handleMove}\r\n        onColumnsChange={handleColumnsChange}\r\n        onAddTask={handleAddTask}\r\n        onOpenTask={(taskId) => console.log(\"open task\", taskId)}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}