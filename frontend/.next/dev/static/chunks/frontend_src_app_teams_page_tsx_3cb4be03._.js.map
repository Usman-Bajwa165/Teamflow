{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["C:/Users/Window/Desktop/Teamflow/frontend/src/app/teams/page.tsx"],"sourcesContent":["\"use client\";\r\n// frontend/src/app/teams/page.tsx\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { getMyTeams, createTeam } from \"../../lib/api\";\r\nimport { useAuth } from \"../../context/AuthContext\";\r\nimport Link from \"next/link\";\r\n\r\ntype TeamListItem = {\r\n  id?: string | null;\r\n  name: string;\r\n  role: string;\r\n  raw?: any;\r\n};\r\n\r\nexport default function TeamsPage() {\r\n  const { accessToken } = useAuth();\r\n  const [teams, setTeams] = useState<TeamListItem[]>([]);\r\n  const [name, setName] = useState(\"\");\r\n  const [msg, setMsg] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!accessToken) return;\r\n    (async () => {\r\n      try {\r\n        const res = await getMyTeams();\r\n        // res may be:\r\n        // - an array of membership objects { team: {...}, role: 'member', ... }\r\n        // - an array of team objects (when admin) { id, name, members, ... }\r\n        const normalized = (res || []).map((m: any) => {\r\n          // If object has `.team` then it's a membership row\r\n          if (\r\n            m &&\r\n            typeof m === \"object\" &&\r\n            m.team &&\r\n            typeof m.team === \"object\"\r\n          ) {\r\n            return {\r\n              id: m.team.id ?? null,\r\n              name: m.team.name ?? \"—\",\r\n              role: m.role ?? \"member\",\r\n              raw: m,\r\n            };\r\n          }\r\n\r\n          // If object looks like a team (has members/projects or name)\r\n          if (\r\n            m &&\r\n            typeof m === \"object\" &&\r\n            (m.members || m.projects || m.name)\r\n          ) {\r\n            return {\r\n              id: m.id ?? null,\r\n              name: m.name ?? \"—\",\r\n              role: \"admin\", // when admin listing teams, role isn't per-team; treat as admin view\r\n              raw: m,\r\n            };\r\n          }\r\n\r\n          // fallback: if it's a membership-like object with id/name at top-level\r\n          if (m && typeof m === \"object\" && (m.id || m.name)) {\r\n            return {\r\n              id: m.id ?? null,\r\n              name: m.name ?? \"—\",\r\n              role: m.role ?? \"member\",\r\n              raw: m,\r\n            };\r\n          }\r\n\r\n          // last resort: unknown shape\r\n          console.warn(\"Unknown team item shape:\", m);\r\n          return {\r\n            id: null,\r\n            name: \"—\",\r\n            role: \"member\",\r\n            raw: m,\r\n          };\r\n        });\r\n\r\n        setTeams(normalized);\r\n      } catch (e) {\r\n        console.error(\"Failed to fetch teams (getMyTeams) — raw error:\", e);\r\n        setMsg(\"Failed to fetch teams\");\r\n      }\r\n    })();\r\n  }, [accessToken]);\r\n\r\n  async function addTeam(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    setMsg(null);\r\n    if (!name || name.trim().length < 2) {\r\n      setMsg(\"Team name must be at least 2 characters.\");\r\n      return;\r\n    }\r\n    try {\r\n      await createTeam(name.trim());\r\n      setName(\"\");\r\n      const res = await getMyTeams();\r\n      const normalized = (res || []).map((m: any) => {\r\n        if (m && m.team) {\r\n          return {\r\n            id: m.team.id ?? null,\r\n            name: m.team.name ?? \"—\",\r\n            role: m.role ?? \"member\",\r\n            raw: m,\r\n          };\r\n        }\r\n        if (m && (m.members || m.projects || m.name)) {\r\n          return {\r\n            id: m.id ?? null,\r\n            name: m.name ?? \"—\",\r\n            role: \"admin\",\r\n            raw: m,\r\n          };\r\n        }\r\n        if (m && (m.id || m.name)) {\r\n          return {\r\n            id: m.id ?? null,\r\n            name: m.name ?? \"—\",\r\n            role: m.role ?? \"member\",\r\n            raw: m,\r\n          };\r\n        }\r\n        return { id: null, name: \"—\", role: \"member\", raw: m };\r\n      });\r\n      setTeams(normalized || []);\r\n    } catch (err: any) {\r\n      console.error(\"createTeam error:\", err);\r\n      const errMsg = err?.body?.message || \"Failed to create team\";\r\n      setMsg(errMsg);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"text-2xl mb-4\">My teams</h2>\r\n      {msg && <div className=\"mb-3 text-red-600\">{msg}</div>}\r\n      <form onSubmit={addTeam} className=\"mb-4 flex gap-2\">\r\n        <input\r\n          value={name}\r\n          onChange={(e) => setName(e.target.value)}\r\n          placeholder=\"New team name\"\r\n          className=\"px-3 py-2 border rounded flex-1\"\r\n        />\r\n        <button className=\"bg-green-600 text-white px-3 py-2 rounded\">\r\n          Create\r\n        </button>\r\n      </form>\r\n\r\n      <ul className=\"space-y-2\">\r\n        {teams.length === 0 && <div>No teams yet</div>}\r\n        {teams.map((t) => (\r\n          <li\r\n            key={t.id ?? Math.random()}\r\n            className=\"p-3 border rounded flex justify-between items-center\"\r\n          >\r\n            <div>\r\n              <div className=\"font-semibold\">{t.name}</div>\r\n              <div className=\"text-sm text-gray-600\">Role: {t.role}</div>\r\n            </div>\r\n            <div>\r\n              {t.id ? (\r\n                <Link href={`/teams/${t.id}`} className=\"text-sm text-blue-600\">\r\n                  Open\r\n                </Link>\r\n              ) : (\r\n                <span className=\"text-sm text-gray-400\">No id</span>\r\n              )}\r\n            </div>\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["React","useEffect","useState","getMyTeams","createTeam","useAuth","Link","TeamListItem","id","name","role","raw","TeamsPage","accessToken","teams","setTeams","setName","msg","setMsg","res","normalized","map","m","team","members","projects","console","warn","e","error","addTeam","FormEvent","preventDefault","trim","length","err","errMsg","body","message","target","value","t","Math","random"],"mappings":";;;;;AACA,kCAAA;AACA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,UAAU,EAAEC,UAAU,QAAQ,eAAe;AACtD,SAASC,OAAO,QAAQ,2BAA2B;AACnD,OAAOC,IAAI,MAAM,WAAW;;;AAL5B,YAAY;;;;;AAcG;;IACb,MAAM,EAAEO,WAAAA,EAAa;IACrB,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,OAAGb,qLAAQ,CAACK,CAAgB,EAAE,CAAC,QAAP,EAAE,CAAC;IAClD,MAAM,CAACE,IAAI,EAAEO,OAAO,CAAC,OAAGd,qLAAQ,EAAC,EAAE,CAAC;IACpC,MAAM,CAACe,GAAG,EAAEC,MAAM,CAAC,OAAGhB,qLAAQ,CAAC,CAAe,IAAI,CAAb,AAAc,GAAX,IAAI,CAAC;QAE7CD,sLAAS;+BAAC,MAAM;YACd,IAAI,CAACY,WAAW,EAAE;;uCACjB,YAAY;oBACX,IAAI;wBACF,MAAMM,GAAG,GAAG,MAFhB,IAEsBhB,8IAAU,AA2D/B,CA3DgC,CAAC,AA2D/B,CAAC;wBA1DA,cAAA;wBACA,wEAAA;wBACA,qEAAA;wBACA,MAAMiB,UAAU,GAAG,CAACD,GAAG,IAAI,EAAE,EAAEE,GAAG;8DAAC,CAACC,CAAC,EAAE,GAAG,KAAK;gCAC7C,mDAAA;gCACA,IACEA,CAAC,IACD,OAAOA,CAAC,KAAK,QAAQ,IACrBA,CAAC,CAACC,IAAI,IACN,OAAOD,CAAC,CAACC,IAAI,KAAK,QAAQ,EAC1B;oCACA,OAAO;wCACLf,EAAE,EAAEc,CAAC,CAACC,IAAI,CAACf,EAAE,IAAI,IAAI;wCACrBC,IAAI,EAAEa,CAAC,CAACC,IAAI,CAACd,IAAI,IAAI,GAAG;wCACxBC,IAAI,EAAEY,CAAC,CAACZ,IAAI,IAAI,QAAQ;wCACxBC,GAAG,EAAEW;oCACP,CAAC;gCACH;gCAEA,6DAAA;gCACA,IACEA,CAAC,IACD,OAAOA,CAAC,KAAK,QAAQ,IAAA,CACpBA,CAAC,CAACE,OAAO,IAAIF,CAAC,CAACG,QAAQ,IAAIH,CAAC,CAACb,IAAI,CAAC,EACnC;oCACA,OAAO;wCACLD,EAAE,EAAEc,CAAC,CAACd,EAAE,IAAI,IAAI;wCAChBC,IAAI,EAAEa,CAAC,CAACb,IAAI,IAAI,GAAG;wCACnBC,IAAI,EAAE,OAAO;wCAAE,qEAAA;wCACfC,GAAG,EAAEW;oCACP,CAAC;gCACH;gCAEA,uEAAA;gCACA,IAAIA,CAAC,IAAI,OAAOA,CAAC,KAAK,QAAQ,IAAA,CAAKA,CAAC,CAACd,EAAE,IAAIc,CAAC,CAACb,IAAI,CAAC,EAAE;oCAClD,OAAO;wCACLD,EAAE,EAAEc,CAAC,CAACd,EAAE,IAAI,IAAI;wCAChBC,IAAI,EAAEa,CAAC,CAACb,IAAI,IAAI,GAAG;wCACnBC,IAAI,EAAEY,CAAC,CAACZ,IAAI,IAAI,QAAQ;wCACxBC,GAAG,EAAEW;oCACP,CAAC;gCACH;gCAEA,6BAAA;gCACAI,OAAO,CAACC,IAAI,CAAC,0BAA0B,EAAEL,CAAC,CAAC;gCAC3C,OAAO;oCACLd,EAAE,EAAE,IAAI;oCACRC,IAAI,EAAE,GAAG;oCACTC,IAAI,EAAE,QAAQ;oCACdC,GAAG,EAAEW;gCACP,CAAC;4BACH,CAAC,CAAC;;wBAEFP,QAAQ,CAACK,UAAU,CAAC;oBACtB,CAAC,CAAC,OAAOQ,CAAC,EAAE;wBACVF,OAAO,CAACG,KAAK,CAAC,iDAAiD,EAAED,CAAC,CAAC;wBACnEV,MAAM,CAAC,uBAAuB,CAAC;oBACjC;gBACF;;QACF,CAAC;8BAAE;QAACL,WAAW;KAAC,CAAC;IAEjB,eAAeiB,OAAOA,CAACF,GAAC,AAAiB,EAAE,AAAjB5B,KAAK,CAAC+B;QAC9BH,GAAC,CAACI,cAAc,CAAC,CAAC;QAClBd,MAAM,CAAC,IAAI,CAAC;QACZ,IAAI,CAACT,IAAI,IAAIA,IAAI,CAACwB,IAAI,CAAC,CAAC,CAACC,MAAM,GAAG,CAAC,EAAE;YACnChB,MAAM,CAAC,0CAA0C,CAAC;YAClD;QACF;QACA,IAAI;YACF,UAAMd,8IAAU,EAACK,IAAI,CAACwB,IAAI,CAAC,CAAC,CAAC;YAC7BjB,OAAO,CAAC,EAAE,CAAC;YACX,MAAMG,KAAG,GAAG,MAAMhB,kJAAU,CAAC,CAAC;YAC9B,MAAMiB,YAAU,GAAG,CAACD,KAAG,IAAI,EAAE,EAAEE,GAAG,CAAC,CAACC,GAAC,EAAE,GAAG,KAAK;gBAC7C,IAAIA,GAAC,IAAIA,GAAC,CAACC,IAAI,EAAE;oBACf,OAAO;wBACLf,EAAE,EAAEc,GAAC,CAACC,IAAI,CAACf,EAAE,IAAI,IAAI;wBACrBC,IAAI,EAAEa,GAAC,CAACC,IAAI,CAACd,IAAI,IAAI,GAAG;wBACxBC,IAAI,EAAEY,GAAC,CAACZ,IAAI,IAAI,QAAQ;wBACxBC,GAAG,EAAEW;oBACP,CAAC;gBACH;gBACA,IAAIA,GAAC,IAAA,CAAKA,GAAC,CAACE,OAAO,IAAIF,GAAC,CAACG,QAAQ,IAAIH,GAAC,CAACb,IAAI,CAAC,EAAE;oBAC5C,OAAO;wBACLD,EAAE,EAAEc,GAAC,CAACd,EAAE,IAAI,IAAI;wBAChBC,IAAI,EAAEa,GAAC,CAACb,IAAI,IAAI,GAAG;wBACnBC,IAAI,EAAE,OAAO;wBACbC,GAAG,EAAEW;oBACP,CAAC;gBACH;gBACA,IAAIA,GAAC,IAAA,CAAKA,GAAC,CAACd,EAAE,IAAIc,GAAC,CAACb,IAAI,CAAC,EAAE;oBACzB,OAAO;wBACLD,EAAE,EAAEc,GAAC,CAACd,EAAE,IAAI,IAAI;wBAChBC,IAAI,EAAEa,GAAC,CAACb,IAAI,IAAI,GAAG;wBACnBC,IAAI,EAAEY,GAAC,CAACZ,IAAI,IAAI,QAAQ;wBACxBC,GAAG,EAAEW;oBACP,CAAC;gBACH;gBACA,OAAO;oBAAEd,EAAE,EAAE,IAAI;oBAAEC,IAAI,EAAE,GAAG;oBAAEC,IAAI,EAAE,QAAQ;oBAAEC,GAAG,EAAEW;gBAAE,CAAC;YACxD,CAAC,CAAC;YACFP,QAAQ,CAACK,YAAU,IAAI,EAAE,CAAC;QAC5B,CAAC,CAAC,OAAOe,GAAG,EAAE,AAAK,GAAF;YACfT,OAAO,CAACG,KAAK,CAAC,mBAAmB,EAAEM,GAAG,CAAC;YACvC,MAAMC,MAAM,GAAGD,GAAG,EAAEE,IAAI,EAAEC,OAAO,IAAI,uBAAuB;YAC5DpB,MAAM,CAACkB,MAAM,CAAC;QAChB;IACF;IAEA,qBACE,yMAAC,GAAG,CAAC;;0BACH,yMAAC,EAAE;gBAAC,SAAS,EAAC,eAAe;0BAAC,QAAQ,EAAE,EAAE,CAAC;;;;;;YAC1CnB,GAAG,kBAAI,yMAAC,GAAG;gBAAC,SAAS,EAAC,mBAAmB,CAAC;0BAACA,GAAG,CAAC,EAAE,GAAG,CAAC,CAAC;;;;;;0BACvD,yMAAC,IAAI;gBAAC,QAAQ,CAAC,CAACa,OAAO,CAAC;gBAAC,SAAS,EAAC,iBAAiB,CAAC;;kCACnD,yMAAC,KAAK;wBACJ,KAAK,CAAC,CAACrB,IAAI,CAAC;wBACZ,QAAQ,CAAC,EAAEmB,GAAC,GAAKZ,OAAO,CAACY,GAAC,CAACW,MAAM,CAACC,KAAK,CAAC,CAAC;wBACzC,WAAW,EAAC,eAAe;wBAC3B,SAAS,EAAC,iCAAiC,GAC3C;;;;;;kCACF,yMAAC,MAAM;wBAAC,SAAS,EAAC,2CAA2C;kCAAC;;;;;;;;;;;;0BAKhE,yMAAC,EAAE;gBAAC,SAAS,EAAC,WAAW,CAAC;;oBACvB1B,KAAK,CAACoB,MAAM,KAAK,CAAC,kBAAI,yMAAC,GAAG;kCAAC,YAAY,EAAE,GAAG,CAAC,CAAC;;;;;;oBAC9CpB,KAAK,CAACO,GAAG,EAAEoB,CAAC,iBACX,yMAAC,EAAE,CACD,GAAG,CAAC;4BACJ,SAAS,EAAC,sDAAsD,CACjE;;8CACC,yMAAC,GAAG,CAAC;;sDACH,yMAAC,GAAG;4CAAC,SAAS,EAAC,eAAe,CAAC;sDAACA,CAAC,CAAChC,IAAI,CAAC,EAAE,GAAG,CAAC;;;;;;sDAC7C,yMAAC,GAAG;4CAAC,SAAS,EAAC,uBAAuB;;gDAAC,MAAM;gDAACgC,CAAC,CAAC/B,IAAI,CAAC,EAAE,GAAG,CAAC;;;;;;;;;;;;;8CAE7D,yMAAC,GAAG,CAAC;8CACF+B,CAAC,CAACjC,EAAE,iBACH,yMAAC,sLAAI;wCAAC,IAAI,CAAC,CAAC,CAAA,OAAA,EAAUiC,CAAC,CAACjC,EAAE,EAAE,CAAC;wCAAC,SAAS,EAAC,uBAAuB;kDAAC;;;;;6DAIhE,yMAAC,IAAI;wCAAC,SAAS,EAAC,uBAAuB;kDAAC,KAAK,EAAE,IAAI,CACpD,CAAC;;;;;;;;;;;;2BAdCiC,CAAC,CAACjC,EAAE,IAAIkC,IAAI,CAACC,MAAM,CAAC,CAAC,CAAC;;;;;;;;;;;;;;;;;AAqBvC;;;QA9J0BtC,wJAAO,CAAC,CAAC;;;KADXO,SAASA,CAAA,EAAG","ignoreList":[],"debugId":null}}]
}