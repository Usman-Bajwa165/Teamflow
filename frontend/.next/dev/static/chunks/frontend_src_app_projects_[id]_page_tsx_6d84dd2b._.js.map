{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["C:/Users/Window/Desktop/Teamflow/frontend/src/app/projects/[id]/page.tsx"],"sourcesContent":["\"use client\";\r\n// frontend/src/app/projects/[id]/page.tsx\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useParams } from \"next/navigation\";\r\nimport {\r\n  getProject,\r\n  createColumn,\r\n  createTask,\r\n  moveTask,\r\n} from \"../../../lib/api\";\r\nimport TaskBoard, { Column } from \"../../../src/components/TaskBoard\";\r\n\r\nexport default function ProjectBoard() {\r\n  const params = useParams();\r\n  const projectId = params.id;\r\n  const [project, setProject] = useState<any>(null);\r\n  const [newColTitle, setNewColTitle] = useState(\"\");\r\n  const [newTaskTitles, setNewTaskTitles] = useState<Record<string, string>>(\r\n    {}\r\n  );\r\n  const [msg, setMsg] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      if (!projectId) return;\r\n      try {\r\n        const p = await getProject(projectId);\r\n        const normalized = {\r\n          ...p,\r\n          columns: (p?.columns || []).map((c: any) => ({\r\n            ...c,\r\n            tasks: c?.tasks || [],\r\n          })),\r\n        };\r\n        setProject(normalized);\r\n      } catch (err) {\r\n        setMsg(\"Failed to load project\");\r\n      }\r\n    })();\r\n  }, [projectId]);\r\n\r\n  async function addColumn(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    setMsg(null);\r\n    const title = (newColTitle || \"\").trim();\r\n    if (!title) {\r\n      setMsg(\"Column title required\");\r\n      return;\r\n    }\r\n    try {\r\n      const col = await createColumn(project.id, title);\r\n      const newCol = { ...col, tasks: col?.tasks || [] };\r\n      setProject((prev) => ({\r\n        ...(prev || {}),\r\n        columns: (prev?.columns || []).concat(newCol),\r\n      }));\r\n      setNewColTitle(\"\");\r\n    } catch (err: any) {\r\n      setMsg(err?.body?.message || \"Failed to create column\");\r\n    }\r\n  }\r\n\r\n  async function addTask(columnId: string) {\r\n    setMsg(null);\r\n    const title = (newTaskTitles[columnId] || \"\").trim();\r\n    if (!title) {\r\n      setMsg(\"Task title required\");\r\n      return;\r\n    }\r\n    try {\r\n      const t = await createTask(columnId, title);\r\n      setProject((prev) => ({\r\n        ...(prev || {}),\r\n        columns: (prev?.columns || []).map((c: any) =>\r\n          c.id === columnId ? { ...c, tasks: [...(c.tasks || []), t] } : c\r\n        ),\r\n      }));\r\n      setNewTaskTitles((prev) => ({ ...prev, [columnId]: \"\" }));\r\n    } catch (err: any) {\r\n      setMsg(err?.body?.message || \"Failed to create task\");\r\n    }\r\n  }\r\n\r\n  // controlled columns-change callback used by TaskBoard for optimistic updates & rollback\r\n  function handleColumnsChange(cols: Column[]) {\r\n    setProject((prev) => ({ ...(prev || {}), columns: cols }));\r\n  }\r\n\r\n  // forwarded API call; TaskBoard manages optimistic UI via handleColumnsChange\r\n  async function handleMove(\r\n    taskId: string,\r\n    targetColumnId: string,\r\n    targetPosition: number\r\n  ) {\r\n    await moveTask(taskId, targetColumnId, targetPosition);\r\n    // optional: re-fetch canonical data here if you want to ensure server canonicality:\r\n    // const p = await getProject(projectId); setProject({...normalized p...})\r\n  }\r\n\r\n  if (!project) return <div>Loading project...</div>;\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"text-2xl font-bold mb-4\">{project.name}</h2>\r\n      {msg && <div className=\"mb-3 text-red-600\">{msg}</div>}\r\n\r\n      <div className=\"mb-4\">\r\n        <form onSubmit={addColumn} className=\"flex gap-2\">\r\n          <input\r\n            value={newColTitle}\r\n            onChange={(e) => setNewColTitle(e.target.value)}\r\n            placeholder=\"New column title\"\r\n            className=\"px-3 py-2 border rounded flex-1\"\r\n          />\r\n          <button className=\"bg-slate-600 text-white px-3 py-2 rounded\">\r\n            Add column\r\n          </button>\r\n        </form>\r\n      </div>\r\n\r\n      <TaskBoard\r\n        columns={project.columns as Column[]}\r\n        onMove={handleMove}\r\n        onColumnsChange={handleColumnsChange}\r\n        onOpenTask={(taskId) => console.log(\"open task\", taskId)}\r\n      />\r\n\r\n      <div className=\"mt-6 grid gap-4 md:grid-cols-3\">\r\n        {(project.columns || []).map((col: any) => (\r\n          <div key={col.id} className=\"p-2\">\r\n            <input\r\n              value={newTaskTitles[col.id] || \"\"}\r\n              onChange={(e) =>\r\n                setNewTaskTitles((prev) => ({\r\n                  ...prev,\r\n                  [col.id]: e.target.value,\r\n                }))\r\n              }\r\n              placeholder={`New task in ${col.title}`}\r\n              className=\"w-full px-2 py-1 border rounded mb-2\"\r\n            />\r\n            <button\r\n              onClick={() => addTask(col.id)}\r\n              className=\"w-full bg-green-600 text-white py-1 rounded\"\r\n            >\r\n              Add task\r\n            </button>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["React","useEffect","useState","useParams","getProject","createColumn","createTask","moveTask","TaskBoard","Column","ProjectBoard","params","projectId","id","project","setProject","newColTitle","setNewColTitle","newTaskTitles","setNewTaskTitles","Record","msg","setMsg","p","normalized","columns","map","c","tasks","err","addColumn","e","FormEvent","preventDefault","title","trim","col","newCol","prev","concat","body","message","addTask","columnId","t","handleColumnsChange","cols","handleMove","taskId","targetColumnId","targetPosition","name","target","value","console","log"],"mappings":";;;;;AACA,0CAAA;AACA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,SAAS,QAAQ,iBAAiB;AAC3C,SACEC,UAAU,EACVC,YAAY,EACZC,UAAU,EACVC,QAAQ,QACH,kBAAkB;;;;;;;;AATzB,YAAY;;;;;AAYG;;IACb,MAAMI,MAAM;IACZ,MAAMC,SAAS,GAAGD,MAAM,CAACE,EAAE;IAC3B,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,OAAGb,qLAAQ,CAAC,CAAK,EAAF,CAAC,CAAK,CAAC;IACjD,MAAM,CAACc,WAAW,EAAEC,cAAc,CAAC,OAAGf,qLAAQ,EAAC,EAAE,CAAC;IAClD,MAAM,CAACgB,aAAa,EAAEC,gBAAgB,CAAC,OAAGjB,qLAAQ,CAACkB,CACjD,CAAC,CACH,CAAC,EAFwD,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;IAG1E,MAAM,CAACC,GAAG,EAAEC,MAAM,CAAC,OAAGpB,qLAAQ,CAAC,CAAe,IAAI,CAAb,AAAc,GAAX,IAAI,CAAC;QAE7CD,sLAAS;kCAAC,MAAM;YACd;0CAAC,YAAY;oBACX,IAAI,CAACW,SAAS,EAAE;oBAChB,IAAI;wBACF,MAAMW,CAAC,GAAG,UAAMnB,8IAAU,AAY7B,EAZ8BQ,AAY5B,CAAC,QAZoC,CAAC;wBACrC,MAAMY,UAAU,GAAG;4BACjB,GAAGD,CAAC;4BACJE,OAAO,EAAE,CAACF,CAAC,EAAEE,OAAO,IAAI,EAAE,EAAEC,GAAG;0DAAC,CAACC,CAAC,EAAE,CAAG,CAAM,CAAN;wCACrC,GAAGA,CAAC;wCACJC,KAAK,EAAED,CAAC,EAAEC,KAAK,IAAI,EAAA;oCACrB,CAAC,CAAC;;wBACJ,CAAC;wBACDb,UAAU,CAACS,UAAU,CAAC;oBACxB,CAAC,CAAC,OAAOK,GAAG,EAAE;wBACZP,MAAM,CAAC,wBAAwB,CAAC;oBAClC;gBACF;;QACF,CAAC;iCAAE;QAACV,SAAS;KAAC,CAAC;IAEf,eAAekB,SAASA,CAACC,CAAC,AAAiB,EAAf/B,AAAiB,KAAZ,CAACgC;QAChCD,CAAC,CAACE,cAAc,CAAC,CAAC;QAClBX,MAAM,CAAC,IAAI,CAAC;QACZ,MAAMY,KAAK,GAAG,CAAClB,WAAW,IAAI,EAAE,EAAEmB,IAAI,CAAC,CAAC;QACxC,IAAI,CAACD,KAAK,EAAE;YACVZ,MAAM,CAAC,uBAAuB,CAAC;YAC/B;QACF;QACA,IAAI;YACF,MAAMc,GAAG,GAAG,UAAM/B,gJAAY,EAACS,OAAO,CAACD,EAAE,EAAEqB,KAAK,CAAC;YACjD,MAAMG,MAAM,GAAG;gBAAE,GAAGD,GAAG;gBAAER,KAAK,EAAEQ,GAAG,EAAER,KAAK,IAAI,EAAA;YAAG,CAAC;YAClDb,UAAU,EAAEuB,IAAI,GAAA,CAAM;oBACpB,GAAIA,IAAI,IAAI,CAAC,CAAC,CAAC;oBACfb,OAAO,EAAE,CAACa,IAAI,EAAEb,OAAO,IAAI,EAAE,EAAEc,MAAM,CAACF,MAAM;gBAC9C,CAAC,CAAC,CAAC;YACHpB,cAAc,CAAC,EAAE,CAAC;QACpB,CAAC,CAAC,OAAOY,KAAG,EAAE,AAAK,GAAF;YACfP,MAAM,CAACO,KAAG,EAAEW,IAAI,EAAEC,OAAO,IAAI,yBAAyB,CAAC;QACzD;IACF;IAEA,eAAeC,OAAOA,CAACC,QAAQ,AAAQ,EAAN,AAAQ;QACvCrB,MAAM,CAAC,IAAI,CAAC;QACZ,MAAMY,OAAK,GAAG,CAAChB,aAAa,CAACyB,QAAQ,CAAC,IAAI,EAAE,EAAER,IAAI,CAAC,CAAC;QACpD,IAAI,CAACD,OAAK,EAAE;YACVZ,MAAM,CAAC,qBAAqB,CAAC;YAC7B;QACF;QACA,IAAI;YACF,MAAMsB,CAAC,GAAG,UAAMtC,8IAAU,EAACqC,QAAQ,EAAET,OAAK,CAAC;YAC3CnB,UAAU,EAAEuB,MAAI,GAAA,CAAM;oBACpB,GAAIA,MAAI,IAAI,CAAC,CAAC,CAAC;oBACfb,OAAO,EAAE,CAACa,MAAI,EAAEb,OAAO,IAAI,EAAE,EAAEC,GAAG,CAAC,CAACC,GAAC,EAAE,CACrCA,EADwC,CACvC,CAACd,EAAE,KAAK8B,QAAQ,GAAG;4BAAE,GAAGhB,GAAC;4BAAEC,KAAK,EAAE,CAAC;mCAAID,GAAC,CAACC,KAAK,IAAI,EAAE,CAAC;gCAAEgB,CAAC;6BAAA;wBAAE,CAAC,GAAGjB,GACjE;gBACF,CAAC,CAAC,CAAC;YACHR,gBAAgB,CAAEmB,MAAI,IAAA,CAAM;oBAAE,GAAGA,MAAI;oBAAE,CAACK,QAAQ,CAAA,EAAG;gBAAG,CAAC,CAAC,CAAC;QAC3D,CAAC,CAAC,OAAOd,KAAG,EAAE,AAAK,GAAF;YACfP,MAAM,CAACO,KAAG,EAAEW,IAAI,EAAEC,OAAO,IAAI,uBAAuB,CAAC;QACvD;IACF;IAEA,yFAAA;IACA,SAASI,mBAAmBA,CAACC,IAAI,AAAU,EAARrC,AAAU,MAAJ;QACvCM,UAAU,EAAEuB,MAAI,GAAA,CAAM;gBAAE,GAAIA,MAAI,IAAI,CAAC,CAAC,CAAC;gBAAEb,OAAO,EAAEqB;YAAK,CAAC,CAAC,CAAC;IAC5D;IAEA,8EAAA;IACA,eAAeC,UAAUA,CACvBC,MAAM,AAAQ,EACdC,AADQ,cACM,AAAQ,EAAN,AAChBC,cAAc,AAAQ,EAAN,AAChB;QACA,UAAM3C,4IAAQ,EAACyC,MAAM,EAAEC,cAAc,EAAEC,cAAc,CAAC;IACtD,oFAAA;IACA,0EAAA;IACF;IAEA,IAAI,CAACpC,OAAO,EAAE,qBAAO,yMAAC,GAAG;kBAAC,kBAAkB,EAAE,GAAG,CAAC;;;;;;IAElD,qBACE,yMAAC,GAAG,CAAC;;0BACH,yMAAC,EAAE;gBAAC,SAAS,EAAC,yBAAyB,CAAC;0BAACA,OAAO,CAACqC,IAAI,CAAC,EAAE,EAAE,CAAC;;;;;;YAC1D9B,GAAG,kBAAI,yMAAC,GAAG;gBAAC,SAAS,EAAC,mBAAmB,CAAC;0BAACA,GAAG,CAAC,EAAE,GAAG,CAAC,CAAC;;;;;;0BAEvD,yMAAC,GAAG;gBAAC,SAAS,EAAC,MAAM,CAAC;wCACpB,yMAAC,IAAI;oBAAC,QAAQ,CAAC,CAACS,SAAS,CAAC;oBAAC,SAAS,EAAC,YAAY,CAAC;;sCAChD,yMAAC,KAAK;4BACJ,KAAK,CAAC,CAACd,WAAW,CAAC;4BACnB,QAAQ,CAAC,EAAEe,GAAC,GAAKd,cAAc,CAACc,GAAC,CAACqB,MAAM,CAACC,KAAK,CAAC,CAAC;4BAChD,WAAW,EAAC,kBAAkB;4BAC9B,SAAS,EAAC,iCAAiC,GAC3C;;;;;;sCACF,yMAAC,MAAM;4BAAC,SAAS,EAAC,2CAA2C;sCAAC;;;;;;;;;;;;;;;;;0BAMlE,yMAAC,SAAS;gBACR,OAAO,CAAC,CAACvC,OAAO,CAACW,OAAO,IAAIhB,MAAM,EAAE,CAAC;gBACrC,MAAM,CAAC,CAACsC,UAAU,CAAC;gBACnB,eAAe,CAAC,CAACF,mBAAmB,CAAC;gBACrC,UAAU,CAAC,EAAEG,QAAM,GAAKM,OAAO,CAACC,GAAG,CAAC,WAAW,EAAEP,QAAM,CAAC,CAAC,GACzD;;;;;;0BAEF,yMAAC,GAAG;gBAAC,SAAS,EAAC,gCAAgC,CAAC;0BAC7C,CAAClC,OAAO,CAACW,OAAO,IAAI,EAAE,EAAEC,GAAG,CAAC,CAACU,KAAG,EAAE,GAAG,YACpC,yMAAC,GAAG,CAAC,GAAG,CAAC;wBAAS,SAAS,EAAC,KAAK,CAAC;;0CAChC,yMAAC,KAAK;gCACJ,KAAK,CAAC,CAAClB,aAAa,CAACkB,KAAG,CAACvB,EAAE,CAAC,IAAI,EAAE,CAAC;gCACnC,QAAQ,CAAC,EAAEkB,GAAC,GACVZ,gBAAgB,EAAEmB,MAAI,GAAA,CAAM;4CAC1B,GAAGA,MAAI;4CACP,CAACF,KAAG,CAACvB,EAAE,CAAA,EAAGkB,GAAC,CAACqB,MAAM,CAACC,KAAAA;wCACrB,CAAC,CAAC,CACJ,CAAC;gCACD,WAAW,CAAC,CAAC,CAAA,YAAA,EAAejB,KAAG,CAACF,KAAK,EAAE,CAAC;gCACxC,SAAS,EAAC,sCAAsC,GAChD;;;;;;0CACF,yMAAC,MAAM;gCACL,OAAO,CAAC,CAAC,IAAMQ,OAAO,CAACN,KAAG,CAACvB,EAAE,CAAC,CAAC;gCAC/B,SAAS,EAAC,6CAA6C;0CACxD;;;;;;;uBAfOuB,KAAG,CAACvB,EAAE,CAAC;;;;;;;;;;;;;;;;AAuB3B;;;QA3IiBV,8JAAS,CAAC,CAAC;;;KADJO,YAAYA,CAAA,EAAG","ignoreList":[],"debugId":null}}]
}